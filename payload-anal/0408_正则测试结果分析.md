# 正则测试结果分析
[0407_权限语句正则测试.md](./0407_权限语句正则测试.md)  

[0408_类&方法正则测试.md](./0408_类&方法正则测试.md)

```js
// 权限语句正则测试
// 1
/*
* 初步结论
* _memberAccess: high
* context[]: low
*/
// high risk
%{#_memberAccess.allowStaticMethodAccess=true,
    #context["xwork.MethodAccessor.denyMethodExecution"]=false,
    @sun.misc.Unsafe@getUnsafe()}

// high risk
%{#_memberAccess=a,
    #context["a"]=a,
    @a@a()}

// high risk
%{#_memberAccess,
    #a["a"],
    @a@a()}

// normal
%{#a=a,
    #a["a"]=a,
    @a@a()}

// normal
%{#a,
    #context,
    @a@a()}

// low risk
%{#a,
    #context["a"],
    @a@a()}

// high risk
%{#_memberAccess,
    #a["a"],
    @a@a()}


// 2
/*
* 结论同 1
*/
// high risk
%{#_memberAccess["allowStaticMethodAccess"]=true,
    @sun.misc.Unsafe@getUnsafe()}

// high risk
%{#_memberAccess["a"]=a, @a@a()} 

// normal
%{#a["a"]=a, @a@a()} 

// low risk
%{#a["a"],    
    #context["a"],    
    @a@a()}

// high risk
%{#_memberAccess["a"],    
    @a@a()}


// 3
// high risk
%{#_memberAccess.excludeProperties=@java.util.Collections@EMPTY_SET,    
    @sun.misc.Unsafe@getUnsafe()}

// high risk
%{#_memberAccess.a=@EMPTY_SET@java.util.Collections,    
    @sun.misc.Unsafe@getUnsafe()}

// high risk
%{#_memberAccess=@a@a,
    @a@a()}

// normal
%{#_memberAccess=@a,
    @a@a()}

// normal
%{#_memberAccess,
    @a@a()}

// 4
// 这个有点玄乎
// high risk
%{#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,
    @sun.misc.Unsafe@getUnsafe()}

// high risk
%{@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,
    @a@a()}

// high risk
%{@DEFAULT_MEMBER_ACCESS@ognl.OgnlContext,
    @a@a()}

// high risk
%{@OgnlContext@DEFAULT_MEMBER_ACCESS,
    @a@a()}

// high risk
%{@OgnlContext@a,
    @a@a()}

// high risk
%{@ognl.OgnlContext}

// normal
%{#a=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,
    @sun.misc.Unsafe@getUnsafe()}

// normal
%{#_memberAccess=@ognl.OgnlContext,
    @sun.misc.Unsafe@getUnsafe()}
```

```js
// 1, 2, 3 初步结论
// 最简单形式
// high risk
%{#_memberAccess,
    #a["a"],
    @a@a()}

// high risk
%{#_memberAccess["a"],    
    @a@a()}

// high risk
%{#_memberAccess=@a@a,
    @a@a()}

// low risk
%{#a,
    #context["a"],
    @a@a()}

// low risk
%{#a["a"],    
    #context["a"],    
    @a@a()}
```

```js
// 类 & 方法正则测试
// 1
// high risk
%{@java.lang.ClassLoader@loadClass()}

// high risk
%{@loadClass()@java.lang.ClassLoader}

// high risk
%{@java.lang.ClassLoader@a()}

// high risk
%{@a()@java.lang.ClassLoader}

// normal 
%{@ClassLoader@loadClass()}


// 2
// high risk
%{@java.lang.ProcessBuilder@command(List<String> command)}

// high risk
%{@a()@java.lang.ProcessBuilder}

// high risk
%{@ProcessBuilder@a()}

// high risk
%{@ProcessBuilder@a}

// high risk
%{@a@ProcessBuilder}

// normal
%{@a()@ProcessBuilder}
```