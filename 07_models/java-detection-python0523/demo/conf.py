# 配置文件
# 运行项目所需的全局变量定义在此文件
# 该文件由script/update.py生成

import ctypes
from ctypes import *
from ctypes import cdll
import re

# 通过CDLL方法调用C代码的可执行文件，C代码位于engine文件夹下
class parserStruct(Structure):
    _fields_ = [("input_len",c_int),("full_token_list",POINTER(c_int))]
detectionEngine = cdll.LoadLibrary("./engine/detection.so")
detectionEngine.lexer.restype = ctypes.POINTER(parserStruct)

# Token号与Token名的对应关系，主要用于词法分析，从engine/detection/include/ognl.tab.h文件生成
tokenDict = {0: 'YYEOF', 256: 'YYerror', 257: 'YYUNDEF', 258: 'AND', 259: 'BEANS', 260: 'BUFFEREDINPUTSTREAM', 261: 'BUFFEREDREADER', 262: 'BYTEARRAYINPUTSTREAM', 263: 'BYTEARRAYOUTPUTSTREAM', 264: 'CHARARRAYREADER', 265: 'CLASS', 266: 'CLASSLOADER', 267: 'COLLECTIONS', 268: 'COMMAND', 269: 'COMPILER', 270: 'CONTENT', 271: 'CONTEXT', 272: 'DATAINPUTSTREAM', 273: 'DEBUG', 274: 'DEFAULT_MEMBER_ACCESS', 275: 'ENTITYMANAGER', 276: 'EXPRESSION', 277: 'FILE_P', 278: 'FILEDESCRIPTOR', 279: 'FILEINPUTSTREAM', 280: 'FILEOUTPUTSTREAM', 281: 'FILEPERMISSION', 282: 'FILEREADER', 283: 'FILEWRITER', 284: 'FILTERINPUTSTREAM', 285: 'FILTEROUTPUTSTREAM', 286: 'FILTERREADER', 287: 'INHERITABLETHREADLOCAL', 288: 'INPUTSTREAM', 289: 'INPUTSTREAMREADER', 290: 'INTEGER', 291: 'IO', 292: 'JAVA', 293: 'JAVAX', 294: 'LANG', 295: 'LINENUMBERREADER', 296: 'MEMBERACCESS', 297: 'MESSAGE', 298: 'MISC', 299: 'NEW', 300: 'NOT', 301: 'NUMBER', 302: 'OBJECT', 303: 'OBJECTOUTPUTSTREAM', 304: 'OGNL', 305: 'OGNLCONTEXT', 306: 'OR', 307: 'OUTPUTSTREAM', 308: 'PACKAGE', 309: 'PERSISTENCE', 310: 'PIPEDOUTPUTSTREAM', 311: 'PIPEDREADER', 312: 'PRINTSTREAM', 313: 'PROCESS', 314: 'PROCESSBUILDER', 315: 'PUSHBACKINPUTSTREAM', 316: 'READER', 317: 'REFLECT', 318: 'RUNTIME', 319: 'RUNTIMEPERMISSION', 320: 'SCANNER', 321: 'SCRIPT', 322: 'SCRIPTENGINEMANAGE', 323: 'SECURITYMANAGER', 324: 'SERVLET', 325: 'SERVLETCONTEXT', 326: 'SHUTDOWN', 327: 'STRING', 328: 'STRINGBUILDER', 329: 'STRINGREADER', 330: 'SUN', 331: 'SYSTEM', 332: 'THREAD', 333: 'THREADGROUP', 334: 'THREADLOCAL', 335: 'TYPE', 336: 'UNSAFE', 337: 'UTIL', 338: 'XMLDECODE', 339: 'XOR', 340: 'EXPRESSION_START', 341: 'EXPRESSION_END', 342: 'DOT_DOT', 343: 'NOT_EQUAL', 344: 'EQUAL', 345: 'LESS_EQUAL', 346: 'GREATER_EQUAL', 347: 'AND_AND', 348: 'OR_OR', 349: 'ICONST', 350: 'BCONST', 351: 'XCONST', 352: 'SCONST', 353: 'USCONST', 354: 'FCONST', 355: 'IDENT', 356: 'UIDENT'}

